{% extends _layout %}

{% block def_title 'Deployment Editor (' ~ manifest.name|default('unknown') ~ ')' %}

{% block frag_container %}
    {% if draft_profile.draft_started %}
        <div class="bg-primary" style="margin:-16px 0 16px;padding:7px 16px 8px 16px;">
            <div class="pull-right">

                &nbsp;
                <a class="btn btn-secondary">Review</a>
            </div>
            <div style="padding:6px 0;">
                Some changes have not yet been applied.
                Last changed on {{ draft_profile.draft_last_date|date('M jS \\a\\t g:i a') }}
            </div>
        </div>
    {% endif %}
    {{ parent() }}
{% endblock %}

{% block frag_sidebar %}
    <ul class="nav">
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_summary', { 'path' : path }), 'Summary', 'info', 'summary', sidenav_active) }}
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_section', { 'section' : 'releases', 'path' : path }), 'Releases', 'leaf', 'releases', sidenav_active) }}
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_section', { 'section' : 'networks', 'path' : path }), 'Networks', 'exchange', 'networks', sidenav_active) }}
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_section', { 'section' : 'resourcepools', 'path' : path }), 'Resource Pools', 'cubes', 'resourcepools', sidenav_active) }}
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_section', { 'section' : 'diskpools', 'path' : path }), 'Disk Pools', 'database', 'diskpools', sidenav_active) }}
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_section', { 'section' : 'jobs', 'path' : path }), 'Jobs', 'server', 'jobs', sidenav_active) }}
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_section', { 'section' : 'properties', 'path' : path }), 'Properties', 'cogs', 'properties', sidenav_active) }}
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_edit', { 'path' : path, 'property' : 'compilation' }), 'Compilation', 'cog', 'compilation', sidenav_active) }}
        {{ _self.navlink(path('veneer_ops_workspace_app_deployment_edit', { 'path' : path, 'property' : 'update' }), 'Update', 'cog', 'update', sidenav_active) }}
    </ul>

    <hr />

    <ul class="list-unstyled">
        <li><small><a class="text-muted" href="{{ path('veneer_core_workspace_env_view', { 'path' : path }) }}"><i class="fa fa-dot-circle-o fa-fw"></i> environment</a></small></li>
        <li><small><a class="text-muted" href="{{ path('veneer_core_workspace_repo_blob', { 'path' : path }) }}"><i class="fa fa-code fa-fw"></i> {{ path }}</a></small></li>
    </ul>
{% endblock %}

{% macro navlink(path, title, fontawesome, name, active) %}
    <li class="nav-item">
        {% if name == active %}
            <i class="fa fa-{{ fontawesome }} fa-fw"></i> {{ title }}
        {% else %}
            <a href="{{ path }}" class="nav-link"><i class="fa fa-{{ fontawesome }} fa-fw"></i> {{ title }}</a>
        {% endif %}
    </li>
{% endmacro %}
